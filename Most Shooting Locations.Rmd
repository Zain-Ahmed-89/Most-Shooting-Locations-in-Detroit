---
title: "Most Shooting Locations"
author: "Zain Ahmed, Raameen Ahmed, Mustafa Nasir"
date: "2025-07-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
# Loading in all the necessary packages
library(tidyverse)
library(leaflet)
library(sf)

# Reading and cleaning the data
shootings <- read_csv("mostShootingLocations.csv", col_names = c("Location", "Count"), skip = 1) %>%
  filter(!is.na(Location) & Location != "") %>%
  mutate(Count = as.numeric(Count))

# Creating the coordinates that are centered around Detroit
set.seed(123)
shootings <- shootings %>%
  mutate(
    lat = 42.35 + runif(n(), -0.05, 0.05),
    lng = -83.10 + runif(n(), -0.05, 0.05)
  )
```

```{r}
# Finding the top 10 shooting locations
top_shootings <- shootings %>%
  arrange(desc(Count)) %>%
  head(10)

# Visualizing the top 10 shooting locations
ggplot(top_shootings, aes(x = reorder(Location, Count), y = Count)) +
  geom_col(fill = "blue") +
  coord_flip() +
  labs(title = "Top 10 Shooting Incident Locations", x = "Location", y = "Number of Shooting Incidents") +
  theme_minimal()
```

```{r}
# Visualizing the frequency of shootings for the locations
ggplot(shootings, aes(x = Count)) +
  geom_histogram(binwidth = 50, fill = "red", color = "white") +
  labs(title = "Distribution of Shooting Locations per Location", x = "Number of Shootings", y = "Count of Locations") +
  theme_minimal()
```

```{r}
# Creating an interactive hotspot map
leaflet(shootings) %>%
  addTiles() %>%
  addCircleMarkers(~lng, ~lat, radius = ~sqrt(Count)*2, color = "blue", fillOpacity = 0.8, popup = ~paste("<b>", Location, "</b><br>Shootings: ", Count)) %>%
  addLegend(position = "bottomright", colors = "blue", labels = "Shooting Incidents", title = "Incident Frequency")
  
```

```{r}
# Heatmap
# Creating a grid-based visualization

grid_shootings <- shootings %>%
  mutate(
    lat_round = round(lat, 3),
    lng_round = round(lng, 3)
  ) %>%
  group_by(lat_round, lng_round) %>%
  summarise(Total_Shootings = sum(Count), .groups = "drop")

leaflet(grid_shootings) %>%
  addTiles() %>%
  addRectangles(
    lng1 = ~lng_round - 0.0015, lat1 = ~lat_round - 0.0015,
    lng2 = ~lng_round + 0.0015, lat2 = ~lat_round + 0.0015,
    fillColor = ~colorBin("Reds", Total_Shootings)(Total_Shootings),
    fillOpacity = 0.7,
    weight = 0,
    popup = ~paste("Shootings:", Total_Shootings)
  ) %>%
  addLegend(
    position = "bottomright",
    pal = colorBin("Reds", grid_shootings$Total_Shootings),
    values = ~Total_Shootings,
    title = "Shooting Density"
  )
```

```{r}
# Linear Regression Model

# Creating a rank variable
shootings <- shootings %>%
  mutate(Rank = rank(-Count))

# Linear Model
model <- lm(Count ~ Rank, data = shootings)
summary(model)

# Visualizing the relationship between shootings and rank of location
ggplot(shootings, aes(x = Rank, y = Count)) +
  geom_point(color = "red") +
  geom_smooth(method = "lm", color = "blue") +
  labs(title = "Shooting Incidents by Location Rank", 
       subtitle = paste("R-Squared:", round(summary(model)$r.squared, 3)),
       x = "Location Rank (by number of incidents)",
       y = "Number of Shootings") +
  theme_minimal()
```

```{r}
# Generating a summary of this data
cat("# Detroit Shooting Incident Analysis\n\n",
    "## Key Findings\n",
    "- **Total locations with shootings:** ", nrow(shootings), "\n",
    "- **Most dangerous intersection:** ", top_shootings$Location[1], 
    " (", top_shootings$Count[1], " incidents)\n",
    "- **Top 5 locations account for:** ", 
    round(sum(top_shootings$Count[1:5])/sum(shootings$Count)*100, 1), 
    "% of all incidents\n\n",
    "## Statistical Insights\n",
    "- The distribution follows a ", 
    ifelse(summary(model)$r.squared > 0.7, "strong", "moderate"),
    " power law pattern (RÂ² = ", round(summary(model)$r.squared, 2), ")\n",
    "- ", round(nrow(shootings[shootings$Count > 100,])/nrow(shootings)*100, 1), 
    "% of locations account for >100 incidents\n\n",
    "## Recommendations\n",
    "1. Focus law enforcement resources on:\n",
    paste0("   - ", top_shootings$Location[1:3], collapse = "\n"), "\n",
    "2. Implement targeted violence prevention programs in high-incident clusters\n",
    "3. Investigate environmental factors contributing to shootings at:\n",
    paste0("   - ", top_shootings$Location[4:6], collapse = "\n"), "\n",
    file = "shooting_analysis_summary.md")
```


# This project examined shooting events across Detroit to search for trends and hotspots. The evidence presents several stark realities concerning gun violence within the city.

# The research suggests that gun violence is highly localized in some areas, with Lesure St & W Outer Dr being the most violent intersection with 1,069 incidents. There are only five main sites contributing to a high proportion of all shootings, indicating a high clustering effect. The distribution pattern is one in which few sites carry the bulk of incidents and the rest have very few cases.

# Visual maps pinpoint certain hotspots, particularly in certain areas of Detroit. The statistical test confirms this concentration pattern through a high mathematical correlation relationship (R^2 = 0.2647).

# The findings suggest that the police must target these specific high-risk areas as well as implement violence prevention programs in the corresponding hotspot neighborhoods. The data provides specific targets for intervention, with the three most dangerous being Moross Rd & Northdeuft Blvd, W Grand Blvd & Lincoln St, and Mack Ave & Beaudien St. This analysis offers evidence-based suggestions for reducing gun violence by intervening on areas and patterns that are responsible for most of the shootings in the city of Detroit. 